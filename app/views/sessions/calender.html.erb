<div class="container">
  <div class="row">
    <%= form_tag(:action => 'add_event_to_calendar') do %>
        <div class='col-sm-2'>
          <input type='text' class="form-control" id='datetimepicker4' name="datetext" placeholder="Velg dato og tid"/>
        </div>
        <div class='col-sm-6'>
          <input type='text' class="form-control" name='eventtext' placeholder="Event her"/>
        </div>
        <div class='col-sm-2'>
          <input type='text' class="form-control" name='pricetext' placeholder="Kostnad"/>
        </div>
        <div class='col-sm-10'>
          <input type='text' class="form-control" name='commenttext' placeholder="Legg til en kommentar"/>
        </div>
        <button type="submit" class="btn btn-default">Legg til event</button>
    <% end %>
    <script type="text/javascript">
      $(function () {
        $('#datetimepicker4').datetimepicker();
      });
    </script>
  </div>
</div>

<div class="container">
  <h2>Kyoto</h2>
  <p class="lead">
    En kalender som viser hva vi skal i kyoto fra 11.juli til 18.juli
  </p>

  <div class="alert alert-warning">
    <h4>Hvordan bruke dette</h4>
    <p>For å bruke denne kalenderen, legg til en event.</p>
  </div>

  <hr />

  <div class="agenda">
    <div class="table-responsive">
      <table class="table table-condensed table-bordered">
        <thead>
        <tr>
          <th>Dato</th>
          <th>Klokkeslett</th>
          <th>Event</th>
          <th>Kostnad</th>
          <th>Ulike valg</th>
        </tr>
        </thead>
        <tbody>

        <% for event in @all_events do %>
            <tr>
              <td class="agenda-date" class="active" rowspan="1">
                <div class="shortdate text-muted"><%= event.date %></div>
              </td>
              <td class="agenda-time">
                <%= event.time %>
              </td>
              <td class="agenda-events">
                <div class="agenda-event">
                  <%= event.event %>
                </div>
              </td>
              <td class="agenda-cost">
                <div class="agenda-cost">
                  <%= event.cost %>
                </div>
              </td>

              <td class="agenda-delete">
                <div class="agenda-delete">
                  <%= form_tag(:action => 'delete_event') do %>
                      <button type="submit" value="<%= event.id%>" name="id" class="btn btn-default">Slett event</button>
                      <button type="button" class="open-showCommentModal btn btn-default" data-toggle="modal" data-id="<%= event.comment %>" data-target="#showCommentModal">Se kommentar </button>
                      <button type="button" class="open-editEventModal btn btn-default" data-toggle="modal" data-date="<%= event.date %>" data-event="<%= event.event %>" data-cost="<%= event.cost %>" data-comment="<%= event.comment %>" data-time="<%= event.time %>" data-eventid="<%= event.id %>" data-target="#editEventModal">Endre event </button>
                  <% end %>
                </div>
              </td>
            </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="showCommentModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h2 class="modal-title">
          <p>Kommentar</p>
        </h2>
      </div>
      <div class="modal-body">
        <p id="comment">Ingen kommentarer her...</p>
        <script>
          $(document).on("click", ".open-showCommentModal", function () {
            var myEvent = $(this).data('id');
            var element = document.getElementById("comment");
            element.innerHTML = myEvent;
          });
        </script>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="editEventModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h2 class="modal-title">
          <h4>Oppdater kun det som er nødvendig, la resten stå, save</h4>
        </h2>
      </div>
      <div class="modal-body">
        <%= form_tag(:action => 'update_event') do %>
            <strong><p>Event ID:</p></strong>
            <input type='text' class="form-control" name="eventid" id="eventid" value="" readonly/>
            <strong><p>Dato:</p></strong>
            <input type='text' class="form-control" name="date" id="date" value=""/>
            <strong><p>Event:</p></strong>
            <input type="text" class="form-control" name="event" id="event" value=""/>
            <strong><p>Kostnad:</p></strong>
            <input type="text" class="form-control" name="cost" id="cost" value=""/>
            <strong><p>Klokkeslett:</p></strong>
            <input type="text" class="form-control" name="time" id="time" value=""/>
            <strong><p>Kommentar:</p></strong>
            <input type="text" class="form-control" name="comment" id="comment" value=""/>

            <button type="submit" class="btn btn-default">Oppdater!</button>
        <% end %>


        <script>
          $(document).on("click", ".open-editEventModal", function () {
            var eventid = $(this).data('eventid');
            $(".modal-body #eventid").val( eventid );

            var date = $(this).data('date');
            $(".modal-body #date").val( date );

            var event = $(this).data('event');
            $(".modal-body #event").val( event );

            var cost = $(this).data('cost');
            $(".modal-body #cost").val( cost );

            var time = $(this).data('time');
            $(".modal-body #time").val( time );

            var comment = $(this).data('comment');
            $(".modal-body #comment").val( comment );
          });
        </script>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

